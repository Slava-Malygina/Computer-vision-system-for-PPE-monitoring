### Цель проекта:

 Разработать систему компьютерного зрения для обнаружения средств индивидуальной защиты (СИЗ) - касок, перчаток и жилетокпри входе на предприятие и ведёт журнал нарушений. Это позволит автоматически проверять наличие СИЗ у входящих людей, минимизируя риски на производстве или стройплощадках.
 
###  Основные Задачи:

- Исследовать и выбрать модель для детекции.
- Собрать и подготовить датасет с аннотациями для трёх классов (каски, перчатки, жилетки).
- Обучить модель на данных для достижения точности >80%.
- Интегрировать систему с камерой для реал-тайм работы с FPS >15.
- Реализовать логику журналирования нарушений.



### Сравнение моделей  (одностадийные и многостадийные подходы)


| Название модели         | Описание работы с моделью                                                                  |
|--------------------------|-----------------------------------------------------------------------------------------------------------------------------|
| **YOLOv8** (одностадийная) | **Датасет**: 200-500 фото (Kaggle + свои), аннотации bounding boxes в YOLO-формате;  модель предсказывает bounding boxes и классы (каска, перчатка, жилет) в одном проходе, без разделения этапов. |
| **SSD (MobileNet SSD)** (одностадийная) | **Датасет**: 300-600 фото (больше для точности на мелких объектах), аннотации с anchor boxes (XML или COCO); фокус на разнообразии ракурсов. Аннотация в TensorFlow Object Detection API, баланс классов; модель генерирует предсказания bounding boxes и классов с помощью предопределённых рамок, без поиска регионов.  |
| **EfficientDet (D1)** (одностадийная) | **Датасет**: 400-800 фото (для масштаба), аннотации в COCO-формате (JSON); акцент на освещение/толпу. Аннотация в CVAT, аугментация для мелких объектов;предсказывает bounding boxes и классы в одном проходе.  |
| **Faster R-CNN** (многостадийная) | **Датасет**: 500-1000 фото, аннотации регионов интереса (RPN) в XML. a) Обучение RPN для поиска кандидатных регионов (например, "человек" или "объект"); b) Аннотация в LabelMe, дообучение классификатора (ResNet) для определения "есть ли каска/перчатка/жилет" в регионах; фокус на перекрытиях. |
| **Mask R-CNN** (многостадийная) | **Датасет**: 600-1200 фото, аннотации с масками (пиксельные) в COCO-формате (JSON). a) RPN для регионов; b) Классификатор (ResNet) для классов в регионах; c) Масочная голова для пиксельной сегментации (например, контур каски); аннотация в VGG Image Annotator, фокус на точных границах жилеток. |
| **Cascade R-CNN** (многостадийная) | **Датасет**: 700-1300 фото, аннотации с многоуровневыми IoU (XML/JSON). a) RPN для регионов; b) Первая стадия классификатора (ResNet) для грубой детекции; c) Последующие каскады для уточнения (IoU >0.5, >0.7); аннотация в LabelMe, фокус на высоком IoU для касок. |
-------------

### Существующие подходы к проблеме


| Модели                          | Технологии                             | Обзор                                                                                           | Источник                                                                                     |
|---------------------------------|-----------------------------------------|--------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
| **YOLOv8**                      | Python, OpenCV, представляет собой python-notebook | • Готовый код для дообучения;<br>• Пример преобразования данных в формат пригодный для модели;<br>• Пример визуализации прогнозов<br>**Вывод**: Модель проста в использовании, не требует многоэтапной детекции (поиск человека, головы, рук). | [https://github.com/M3GHAN/YOLOv8-Object-Detection/blob/main/Object_Detection_YOLOv8.ipynb](https://github.com/M3GHAN/YOLOv8-Object-Detection/blob/main/Object_Detection_YOLOv8.ipynb) |
| **Faster R-CNN (сравнение с YOLOv8)** | Detectron2, PyTorch, OpenCV; датасет в YOLO/XML формате | • Сравнение моделей для СИЗ-детекции (каски, жилеты, перчатки) на кастомном датасете;<br>• Включает сбор данных, аннотации и метрики;<br>**Вывод**: Faster R-CNN медленнее YOLO (FPS 5-10), сложнее дообучение. | [https://github.com/brunocestari/PPE-Detection?tab=readme-ov-file](https://github.com/brunocestari/PPE-Detection?tab=readme-ov-file) |
| **YOLOv10**                     | Python, OpenCV, Kaggle датасеты         | • Представлена сравнительная таблица с моделями: Faster R-CNN, SSD500, R-FCN, YOLOv5, YOLOv8. Исследование показывает превосходство в точности у YOLO10;<br>• Есть сравнение четырех разных датасетов с выявлением недостатков;<br>**Вывод**: При выборе модели YOLO есть смысл использовать последние версии для выигрыша в производительности. Есть уже аннотированные датасеты, модели, обученные на них, показывают хорошие результаты. | [https://pmc.ncbi.nlm.nih.gov/articles/PMC12297540/#notes2](https://pmc.ncbi.nlm.nih.gov/articles/PMC12297540/#notes2) |
| **Yolo8x, ResNet101, RCNN ResNet 50 FPN V2** | Python                        | • Сравнение моделей не по теме СИЗ, но отражает реальные возможности и качество детекции тремя моделями;<br>**Вывод**: YOLO8 имеет хорошую поддержку в интернете и успешно развивается. Предобученные модели Resnet не смогли справиться с задачей определения ножей на фотографиях. Попытка дообучить модели Resnet на своем наборе данных также не увенчалась успехом. Для дообучения модели Resnet требуются датасет для обучения большего размера и вычислительные ресурсы. | [https://habr.com/ru/articles/761200/](https://habr.com/ru/articles/761200/) |
| **Inception v3, Faster R-CNN Inception v2** | -                              | • Статья представителей компании, специализирующейся на детекции СИЗ;<br>• Чаще всего используются: <br>  - Модель для классификации изображений Inception v3;<br>  - Модель для детектирования объектов Faster R-CNN Inception v2;<br>**Вывод**: Важно собрать качественный датасет: учесть проблемы с касками не на голове, лысых людей, прически-каре, цвет перчаток. Необходимо подобрать хороший способ разметки, экспериментируя с метриками. | [https://habr.com/ru/companies/center2m/articles/499248/](https://habr.com/ru/companies/center2m/articles/499248/) |

Оптимальным выбором является **YOLOv8**. Эта модель выделяется простотой использования, готовым кодом для дообучения и отсутствием необходимости в многоэтапной детекции


**Faster R-CNN** и другие многостадийные модели (например, с Inception v3) показывают высокую точность на сложных изображенниях , но их медленность (FPS 5-10) и сложность дообучения делают их менее подходящими для реал-тайм. 

## Риски и решения


| Риск                | Описание                                      | Решение                                                                 |
|---------------------|-----------------------------------------------|-------------------------------------------------------------------------|
| Нет датасета         | Проблемы при сборе фото с аннотациями для касок, перчаток, жилеток. | Использовать открытые источники (Kaggle , Roboflow Universe - онлайн-сервис для создания и аугментации датасетов); собрать свои фото (100-200); разделить роли в команде. |
| Недостаток опыта     | Сложность обучения моделей | Следовать туториалам, например, Ultralytics (библиотека для работы с YOLO, предоставляет готовые скрипты) или Detectron2  |
| Ограничения ресурсов | Медленное обучение или низкий скорость детекции | Использовать Colab  (облачная платформа Google с доступом к  графическому процессору для ускорения обучения); оптимизировать модели (YOLOv8n — лёгкая версия YOLO, EfficientDet D0 — базовая версия EfficientDet) |
| Перекрытия объектов  | Модель путает каски,жилетки,перчатки в толпе у входа. | Выбрать модель с хорошей обработкой перекрытий (EfficientDet — детектор с улучшенной архитектурой для сложных сцен); добавить в датасет фото с толпой; тюнинг NMS (non-max suppression - алгоритм фильтрации перекрывающихся рамок). |
